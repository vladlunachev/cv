<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vlad Lunachev - Resume</title>
    
    <!-- Marked.js for markdown parsing -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <style>
        /* Body with gray background */
        body {
            background: #e5e5e5;
            margin: 0;
            padding: 40px 20px;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            font-size: 13px;
            line-height: 1.5;
        }

        /* ==================== CUSTOMIZE BELOW ==================== */

        /* Main resume container - white page with shadow */
        .resume {
            max-width: 800px;
            margin: 0 auto;
            padding: 40px 50px;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        /* Your name (h1) */
        .resume h1 {
            font-size: 24px;
            margin: 0 0 6px 0;
            text-align: center;
            font-weight: 600;
        }

        /* Subtitle line (first paragraph after h1) */
        .resume > p:first-of-type {
            text-align: center;
            margin: 0 0 6px 0;
            font-size: 16px;
        }

        /* Contact info (second paragraph) */
        .resume > p:nth-of-type(2) {
            text-align: center;
            margin: 0 0 12px 0;
            font-size: 12px;
            color: #383838;
        }

        /* Horizontal rules */
        .resume hr {
            margin: 5px 0;
            border: none;
            border-top: 1px solid #c6c6c6;
        }

        /* Section headers (h2) */
        .resume h2 {
            font-size: 16px;
            margin: 5px 0 0px 0;
            font-weight: 600;
            text-transform: uppercase;
            /* border-bottom: 1px solid #333; */
            /* padding-bottom: 3px; */
        }

        /* Job titles (h3) */
        .resume h3 {
            font-size: 14px;
            margin: 0 0 3px 0;
            font-weight: 600;
        }

        /* Company subtitle (em after h3) */
        .resume h3 + p em {
            font-size: 12px;
            color: #555;
        }

        /* All paragraphs */
        .resume p {
            margin: 0 0 8px 0;
            line-height: 1.5;
        }

        /* Job section wrapper */
        .job-section {
            position: relative;
            /* margin-bottom: 20px; */
            margin-top: 5px;
        }

        /* Dates - absolutely positioned inline with job title */
        .job-section .date-line {
            position: absolute;
            top: 0;
            right: 0;
            font-size: 12px;
            color: #666;
            font-weight: 500;
            margin: 0;
        }

        /* Strong text */
        .resume strong {
            font-weight: 600;
        }

        /* Bullet lists */
        .resume ul {
            margin: 8px 0 8px 20px;
            padding: 0;
            break-inside: avoid;
            page-break-inside: avoid;
        }

        /* .resume ul li {
            /* margin-bottom: 4px; */
        /* }

        /* Links */
        .resume a {
            /* color: #0066cc; */
            text-decoration: underline;
            color: #383838;
        }

        .resume a:hover {
            text-decoration: underline;
        }

        /* Center the last paragraph (source link) */
        .resume > p:last-child {
            text-align: center;
            margin-top: 16px;
        }

        @media print {
            @page {
                size: A4;
                margin: 1cm;
            }

            body {
                background: white !important;
                padding: 0 !important;
            }

            .resume {
                box-shadow: none !important;
                padding: 0 !important;
                margin: 0 !important;
            }

            .resume ul {
                break-inside: avoid;
                page-break-inside: avoid;
            }

            .floating-button {
                display: none !important;
            }
        }
        
    </style>
</head>
<body>
    <div id="resume-content"></div>

    <script>
        // Load and render markdown
        async function loadResume() {
            try {
                const response = await fetch('./Vlad_Lunachev_CV-2025-PM.md');
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const markdown = await response.text();
                
                // Configure marked
                marked.setOptions({
                    breaks: true,
                    gfm: true
                });
                
                // Convert markdown to HTML
                const html = marked.parse(markdown);
                
                // Insert into page
                const container = document.getElementById('resume-content');
                container.innerHTML = html;
                
                // Add classes to elements for easy styling
                container.classList.add('resume');
                
                // Add class to header
                const h1 = container.querySelector('h1');
                if (h1) h1.classList.add('resume-name');
                
                // Add classes to all h2 (section headers)
                container.querySelectorAll('h2').forEach(h2 => {
                    h2.classList.add('section-header');
                });
                
                // Add classes to all h3 (job titles)
                container.querySelectorAll('h3').forEach(h3 => {
                    h3.classList.add('job-title');
                });
                
                // Add class to lists
                container.querySelectorAll('ul').forEach(ul => {
                    ul.classList.add('bullet-list');
                });
                
                // Mark date paragraphs and wrap job sections
                const datePattern = /^(January|February|March|April|May|June|July|August|September|October|November|December)?\s*\d{4}\s*-\s*(January|February|March|April|May|June|July|August|September|October|November|December)?\s*\d{4}$/;

                container.querySelectorAll('p').forEach(p => {
                    p.classList.add('paragraph');

                    const text = p.textContent.trim();
                    if (datePattern.test(text)) {
                        p.classList.add('date-line');

                        // Wrap date + h3 + content in a job-section div
                        const nextH3 = p.nextElementSibling;
                        if (nextH3 && nextH3.tagName === 'H3') {
                            // Create wrapper
                            const wrapper = document.createElement('div');
                            wrapper.classList.add('job-section');

                            // Insert wrapper before the date paragraph
                            p.parentNode.insertBefore(wrapper, p);

                            // Move date into wrapper
                            wrapper.appendChild(p);

                            // Move h3 and all following siblings until next date or h2
                            let current = nextH3;
                            while (current) {
                                const next = current.nextElementSibling;

                                // Stop if we hit another date, h2, or hr
                                if ((current.tagName === 'P' && datePattern.test(current.textContent.trim())) ||
                                    current.tagName === 'H2' ||
                                    current.tagName === 'HR') {
                                    break;
                                }

                                wrapper.appendChild(current);
                                current = next;
                            }
                        }
                    }
                });

                // Make all links open in new tab
                container.querySelectorAll('a').forEach(a => {
                    a.setAttribute('target', '_blank');
                    a.setAttribute('rel', 'noopener noreferrer');
                });

            } catch (error) {
                console.error('Error loading resume:', error);
                document.getElementById('resume-content').innerHTML = `
                    <p>Error loading resume. Make sure you're running this from a web server.</p>
                    <p>Try: <code>python3 -m http.server 8000</code></p>
                `;
            }
        }

        window.addEventListener('DOMContentLoaded', loadResume);

        // Create Save as PDF button
        const pdfButton = document.createElement('button');
        pdfButton.type = 'button';
        pdfButton.className = 'floating-button';
        pdfButton.style.cssText = 'position: fixed; top: 20px; right: 20px; width: 180px; background: #374151; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 13px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); z-index: 1000;';
        pdfButton.innerHTML = `
            <svg style="width: 14px; height: 14px; flex-shrink: 0;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"/>
            </svg>
            Save as PDF
        `;
        pdfButton.addEventListener('click', () => window.print());
        pdfButton.addEventListener('mouseenter', () => pdfButton.style.background = '#1f2937');
        pdfButton.addEventListener('mouseleave', () => pdfButton.style.background = '#374151');
        document.body.appendChild(pdfButton);

        // Create Save as Markdown button
        const mdButton = document.createElement('button');
        mdButton.type = 'button';
        mdButton.className = 'floating-button';
        mdButton.style.cssText = 'position: fixed; top: 54px; right: 20px; width: 180px; background: #374151; color: white; border: none; padding: 8px 16px; border-radius: 6px; font-size: 13px; cursor: pointer; display: flex; align-items: center; justify-content: center; gap: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.2); z-index: 1000;';
        mdButton.innerHTML = `
            <svg style="width: 14px; height: 14px; flex-shrink: 0;" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 10v6m0 0l-3-3m3 3l3-3m2 8H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
            </svg>
            Save as Markdown
        `;
        mdButton.addEventListener('click', () => {
            const link = document.createElement('a');
            link.href = 'cv-2025.md';
            link.download = 'vlad-lunachev-cv.md';
            link.click();
        });
        mdButton.addEventListener('mouseenter', () => mdButton.style.background = '#1f2937');
        mdButton.addEventListener('mouseleave', () => mdButton.style.background = '#374151');
        document.body.appendChild(mdButton);
    </script>
</body>
</html>